{% extends "base.html" %}

{% block content %}
<div class="container">
  <h2 class="mt-5 text-center" style="color: black;">เมนูทั้งหมด</h2>
  <div class="row">
    {% for menu in menus %}
    <div class="col-md-3 mb-4">
      <div class="card modern-card fixed-card">
        {% if menu.image %}
        <img src="{{ menu.image.url }}" class="card-img-top fixed-img" alt="{{ menu.name }}">
        {% else %}
        <img src="https://via.placeholder.com/400x300.png?text=ไม่มีรูป" class="card-img-top fixed-img" alt="ไม่มีรูป">
        {% endif %}
        <div class="card-body">
          <h5 class="card-title">{{ menu.name }}</h5>
          <p class="card-text">ราคา: {{ menu.price }}</p>

          <!-- แสดงรีวิวเป็นดาวเดียว + ตัวเลขค่าเฉลี่ย -->
          {% with avg=menu.avg_rating|default:0 %}
          {% if avg > 0 %}
          <div class="star-rating mb-2">
            <i class="bi bi-star-fill"></i>
            <span class="rating-text">{{ avg|floatformat:1 }}</span>
          </div>
          {% else %}
          <span class="rating-text">(ยังไม่มีรีวิว)</span>
          {% endif %}
          {% endwith %}

          <!-- ปุ่มสั่งซื้อ และ รีวิว -->
          <div class="btn-group" role="group">
            <!-- เมื่อกดปุ่มสั่งซื้อ จะไปที่ buy.html -->
            <a href="{% url 'buy' menu.pk %}" class="btn btn-primary square-btn">สั่งซื้อ</a>
            <!-- เมื่อกดปุ่มรีวิว -->
            {% if user.is_authenticated %}
            <a href="{% url 'review' menu.id %}" class="btn btn-secondary square-btn">รีวิว</a>
            {% else %}
            <a href="{% url 'login' %}?next={% url 'review' menu.id %}" class="btn btn-secondary square-btn">รีวิว</a>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    {% empty %}
    <div class="col-12">
      <p class="text-center" style="color: black;">ไม่มีเมนูในขณะนี้</p>
    </div>
    {% endfor %}
  </div>
</div>

<style>
  /* กำหนดให้พื้นหลังของ body เป็นสีเทาอ่อน */
  body {
    background-color: #F5F5F5;
  }

  /* กำหนดขนาดคงที่ให้กับการ์ดทั้งหมด */
  .fixed-card {
    height: 400px;
    /* ปรับขนาดตามความเหมาะสม */
  }

  /* รูปภาพในการ์ด มีขนาดคงที่ และตัดส่วนเกิน */
  .fixed-img {
    width: 100%;
    height: 200px;
    object-fit: cover;
  }

  /* การ์ดแบบ modern-card ไม่มีความโค้งของขอบ */
  .modern-card {
    background-color: #FFFFFF;
    border-radius: 0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    text-align: center;
  }

  /* ปรับการจัดวางเนื้อหาใน card-body ให้เท่ากัน */
  .card-body {
    padding: 15px;
    height: 200px;
    /* กำหนดความสูงของเนื้อหาการ์ดคงที่ */
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }

  /* ปรับสีตัวอักษรในหัวข้อ และรายละเอียดให้เป็นสีดำ */
  .card-title,
  .card-text,
  .rating-text {
    color: black;
  }

  /* ปรับสีและขนาดของไอคอนดาว */
  .star-rating i {
    color: #000000;
    font-size: 1.2rem;
  }

  .rating-text {
    font-weight: bold;
    margin-left: 5px;
  }

  /* ปรับปุ่มให้มีขอบเป็นสี่เหลี่ยม */
  .square-btn {
    border-radius: 0 !important;
  }

  /* จัดกลุ่มปุ่มให้อยู่ในแนวเดียวกันและมีระยะห่างเท่า ๆ กัน */
  .btn-group {
    width: 100%;
    display: flex;
    justify-content: space-around;
  }
</style>
{% endblock %}